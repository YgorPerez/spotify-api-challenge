import { type NextPage } from "next";
import Head from "next/head";
import { useRouter } from "next/router";
import AlbumCard from "../../components/album-card";
import Footer from "../../components/footer";
import Header from "../../components/header";
import Search from "../../components/search-input";
import { api } from "../../utils/api";

const SearchMusicsPage: NextPage = () => {
  const router = useRouter();
  const { search } = router.query;
  const spotifySearch = api.spotify.getSearch.useQuery({
    searchQuery: search as string,
  });

  return (
    <>
      <Head>
        <title>Página de busca</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div className="bg-dark-gray">
        <Header />
        <main className="flex min-h-max flex-col">
          <div className=" bg-dark-gray">
            <div className="mx-32 mb-8">
              <form>
                <label className="ml-2 text-left text-xl  text-white-gray">
                  Busque por artistas, álbuns ou músicas
                </label>
                <Search search={search as string} />
              </form>
              <h2 className="my-4 mt-14 text-3xl text-white-gray">
                Álbuns buscados recentemente
              </h2>
            </div>
            <div className="m-auto flex w-5/6  flex-wrap justify-center gap-6 bg-dark-gray 2xl:w-11/12 2xl:gap-12 ">
              {spotifySearch.data?.albums?.map((album) => {
                return <AlbumCard key={album.id} album={album} />;
              })}
            </div>
          </div>
        </main>
        <footer>
          <Footer />
        </footer>
      </div>
    </>
  );
};

export default SearchMusicsPage;
